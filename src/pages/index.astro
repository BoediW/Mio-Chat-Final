---
import Layout from "../layouts/Layout.astro";
---

<Layout title="Login | Mio Bot">
	<div class="login-page">
		<!-- GIF Background -->
		<div class="gif-background">
			<img
				src="https://i.pinimg.com/originals/ba/42/f8/ba42f8cf58ac119fdbc4256d39769d36.gif"
				alt="K-ON Background"
			/>
		</div>

		<!-- Overlay -->
		<div class="bg-overlay"></div>

		<!-- Login Container -->
		<div class="login-container">
			<div class="login-card glass animate-slide-up">
				<!-- Logo & Header -->
				<div class="login-header">
					<div class="logo-container">
						<div class="logo-icon">
							<img
								src="https://i.pinimg.com/1200x/00/e6/85/00e685341e85eb5d5fdfd3f274455470.jpg"
								alt="Mio Akiyama"
							/>
						</div>
						<h1 class="gradient-text">Login Mio Bot</h1>
					</div>
					<p class="tagline">Mio Akiyama My Kisah</p>
				</div>

				<!-- Login Form -->
				<form id="login-form" class="login-form">
					<div class="input-group">
						<label for="username">
							<svg
								width="16"
								height="16"
								viewBox="0 0 24 24"
								fill="none"
								stroke="currentColor"
								stroke-width="2"
							>
								<path
									d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"
								></path>
								<circle cx="12" cy="7" r="4"></circle>
							</svg>
							USERNAME
						</label>
						<input
							type="text"
							id="username"
							name="username"
							placeholder="Enter your username"
							required
							autocomplete="username"
						/>
					</div>

					<div class="input-group">
						<label for="password">
							<svg
								width="16"
								height="16"
								viewBox="0 0 24 24"
								fill="none"
								stroke="currentColor"
								stroke-width="2"
							>
								<rect
									x="3"
									y="11"
									width="18"
									height="11"
									rx="2"
									ry="2"></rect>
								<path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
							</svg>
							PASSWORD
						</label>
						<div class="password-input-wrapper">
							<input
								type="password"
								id="password"
								name="password"
								placeholder="Enter your password"
								required
								autocomplete="current-password"
							/>
							<button
								type="button"
								class="toggle-password"
								aria-label="Toggle password visibility"
							>
								<svg
									class="eye-open"
									width="20"
									height="20"
									viewBox="0 0 24 24"
									fill="none"
									stroke="currentColor"
									stroke-width="2"
								>
									<path
										d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"
									></path>
									<circle cx="12" cy="12" r="3"></circle>
								</svg>
								<svg
									class="eye-closed hidden"
									width="20"
									height="20"
									viewBox="0 0 24 24"
									fill="none"
									stroke="currentColor"
									stroke-width="2"
								>
									<path
										d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"
									></path>
									<line x1="1" y1="1" x2="23" y2="23"></line>
								</svg>
							</button>
						</div>
					</div>

					<div class="form-options">
						<label class="remember-me">
							<input type="checkbox" id="remember" />
							<span class="checkmark"></span>
							Remember me
						</label>
						<a href="#" class="forgot-link">Forgot password?</a>
					</div>

					<button type="submit" class="login-btn">
						<span>Login to Dashboard</span>
						<svg
							width="20"
							height="20"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
						>
							<path d="M5 12h14M12 5l7 7-7 7"></path>
						</svg>
					</button>
				</form>

				<!-- Divider -->
				<div class="divider">
					<span>Powered by Discord Bot</span>
				</div>

				<!-- Footer -->
				<div class="login-footer">
					<p>ðŸŽ¸ Real-time Chat Dashboard inspired by K-ON!</p>
				</div>
			</div>
		</div>
	</div>
</Layout>

<script>
	// Toggle password visibility
	const toggleBtn = document.querySelector(".toggle-password");
	const passwordInput = document.getElementById(
		"password",
	) as HTMLInputElement;
	const eyeOpen = document.querySelector(".eye-open");
	const eyeClosed = document.querySelector(".eye-closed");

	toggleBtn?.addEventListener("click", () => {
		const type = passwordInput.type === "password" ? "text" : "password";
		passwordInput.type = type;
		eyeOpen?.classList.toggle("hidden");
		eyeClosed?.classList.toggle("hidden");
	});

	// Login form handler
	const form = document.getElementById("login-form");

	form?.addEventListener("submit", (e) => {
		e.preventDefault();
		const formData = new FormData(e.target as HTMLFormElement);
		const username = formData.get("username") as string;
		const password = formData.get("password") as string;

		// Valid credentials
		if (username === "BudiRajaIblis" && password === "BoediGanteng") {
			localStorage.setItem("mio_auth", "true");
			localStorage.setItem("mio_user", username);

			// Add loading state
			const btn = document.querySelector(
				".login-btn",
			) as HTMLButtonElement;
			btn.innerHTML = '<span class="loading">Logging in...</span>';
			btn.disabled = true;

			setTimeout(() => {
				window.location.href = "/dashboard";
			}, 800);
		} else {
			// Show error
			const btn = document.querySelector(
				".login-btn",
			) as HTMLButtonElement;
			btn.classList.add("error");
			btn.innerHTML = "<span>Invalid credentials!</span>";

			setTimeout(() => {
				btn.classList.remove("error");
				btn.innerHTML = `
					<span>Login to Dashboard</span>
					<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
						<path d="M5 12h14M12 5l7 7-7 7"/>
					</svg>
				`;
			}, 2000);
		}
	});

	// Check if already logged in
	if (localStorage.getItem("mio_auth") === "true") {
		window.location.href = "/dashboard";
	}
</script>

<style>
	.login-page {
		min-height: 100vh;
		display: flex;
		align-items: center;
		justify-content: center;
		position: relative;
		overflow: hidden;
		background: #1a1625;
	}

	.gif-background {
		position: absolute;
		inset: 0;
		z-index: 0;
		overflow: hidden;
	}

	.gif-background img {
		width: 100%;
		height: 100%;
		object-fit: cover;
	}

	.bg-overlay {
		position: absolute;
		inset: 0;
		background: linear-gradient(
			135deg,
			rgba(26, 22, 37, 0.5) 0%,
			rgba(45, 31, 71, 0.4) 50%,
			rgba(26, 22, 37, 0.5) 100%
		);
		z-index: 1;
	}

	.login-container {
		position: relative;
		z-index: 10;
		width: 100%;
		max-width: 440px;
		padding: 20px;
	}

	.login-card {
		padding: 40px;
		border-radius: var(--border-radius-xl);
		box-shadow:
			var(--shadow-elevation-high),
			0 0 60px rgba(139, 92, 246, 0.15);
	}

	.login-header {
		text-align: center;
		margin-bottom: 32px;
	}

	.logo-container {
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 12px;
		margin-bottom: 12px;
	}

	.logo-icon {
		width: 80px;
		height: 80px;
		border-radius: 50%;
		overflow: hidden;
		display: flex;
		align-items: center;
		justify-content: center;
		box-shadow: 0 0 30px rgba(139, 92, 246, 0.5);
		animation: glow 3s ease-in-out infinite;
		border: 3px solid var(--brand);
	}

	.logo-icon img {
		width: 100%;
		height: 100%;
		object-fit: cover;
	}

	.login-header h1 {
		font-size: 28px;
		font-weight: 700;
		letter-spacing: -0.5px;
	}

	.tagline {
		color: var(--text-muted);
		font-size: 14px;
	}

	.login-form {
		display: flex;
		flex-direction: column;
		gap: 20px;
	}

	.input-group {
		display: flex;
		flex-direction: column;
		gap: 8px;
	}

	.input-group label {
		display: flex;
		align-items: center;
		gap: 8px;
		color: var(--text-muted);
		font-size: 12px;
		font-weight: 600;
		text-transform: uppercase;
		letter-spacing: 0.5px;
	}

	.input-group label svg {
		opacity: 0.7;
	}

	.input-group input {
		width: 100%;
		padding: 14px 16px;
		background: var(--input-background);
		border: 2px solid transparent;
		border-radius: var(--border-radius-md);
		color: var(--text-normal);
		font-size: 15px;
		transition: all 0.2s ease;
	}

	.input-group input::placeholder {
		color: var(--text-muted);
		opacity: 0.6;
	}

	.input-group input:focus {
		border-color: var(--brand);
		background: rgba(139, 92, 246, 0.05);
	}

	.password-input-wrapper {
		position: relative;
	}

	.password-input-wrapper input {
		padding-right: 48px;
	}

	.toggle-password {
		position: absolute;
		right: 12px;
		top: 50%;
		transform: translateY(-50%);
		background: none;
		padding: 4px;
		color: var(--text-muted);
		transition: color 0.2s;
	}

	.toggle-password:hover {
		color: var(--text-normal);
	}

	.hidden {
		display: none;
	}

	.form-options {
		display: flex;
		justify-content: space-between;
		align-items: center;
	}

	.remember-me {
		display: flex;
		align-items: center;
		gap: 8px;
		color: var(--text-muted);
		font-size: 14px;
		cursor: pointer;
		user-select: none;
	}

	.remember-me input {
		display: none;
	}

	.checkmark {
		width: 18px;
		height: 18px;
		border: 2px solid var(--text-muted);
		border-radius: 4px;
		transition: all 0.2s;
		position: relative;
	}

	.remember-me input:checked + .checkmark {
		background: var(--brand);
		border-color: var(--brand);
	}

	.remember-me input:checked + .checkmark::after {
		content: "âœ“";
		position: absolute;
		color: white;
		font-size: 12px;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
	}

	.forgot-link {
		font-size: 14px;
		color: var(--text-link);
	}

	.login-btn {
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 10px;
		width: 100%;
		padding: 14px 24px;
		background: linear-gradient(
			135deg,
			var(--brand) 0%,
			var(--brand-dark) 100%
		);
		color: white;
		font-size: 16px;
		font-weight: 600;
		border-radius: var(--border-radius-md);
		box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4);
		transition: all 0.3s ease;
	}

	.login-btn:hover {
		transform: translateY(-2px);
		box-shadow: 0 8px 25px rgba(139, 92, 246, 0.5);
	}

	.login-btn:active {
		transform: translateY(0);
	}

	.login-btn.error {
		background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
		box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
	}

	.login-btn :global(.loading) {
		display: flex;
		align-items: center;
		gap: 8px;
	}

	.login-btn :global(.loading)::after {
		content: "";
		width: 16px;
		height: 16px;
		border: 2px solid white;
		border-top-color: transparent;
		border-radius: 50%;
		animation: spin 0.8s linear infinite;
	}

	@keyframes spin {
		to {
			transform: rotate(360deg);
		}
	}

	.divider {
		display: flex;
		align-items: center;
		gap: 16px;
		margin: 24px 0;
	}

	.divider::before,
	.divider::after {
		content: "";
		flex: 1;
		height: 1px;
		background: linear-gradient(
			90deg,
			transparent,
			var(--text-muted),
			transparent
		);
		opacity: 0.3;
	}

	.divider span {
		color: var(--text-muted);
		font-size: 12px;
		white-space: nowrap;
	}

	.login-footer {
		text-align: center;
	}

	.login-footer p {
		color: var(--text-muted);
		font-size: 13px;
	}

	/* Responsive */
	@media (max-width: 480px) {
		.login-card {
			padding: 28px 24px;
		}

		.login-header h1 {
			font-size: 24px;
		}

		.form-options {
			flex-direction: column;
			gap: 12px;
			align-items: flex-start;
		}
	}
</style>
